import React, { useEffect, useRef, useState } from "react";
import { motion, useViewportScroll, useTransform } from "framer-motion";
import { AnimatedSvgWrapper } from "pages/LandingPage/AnimatedSvgWrapper";

export const AnimatedCookbook: React.FC = () => {
  const ref = useRef<HTMLDivElement>();
  const [scrollStart, setScrollStart] = useState(null);
  const [scrollHalf, setScrollHalf] = useState(null);
  const { scrollY } = useViewportScroll();
  const translateLayer2 = useTransform(scrollY, [scrollStart, scrollHalf], [4, 0]);
  const translateLayer3 = useTransform(scrollY, [scrollStart, scrollHalf], [8, 0]);

  useEffect(() => {
    const element = ref.current;
    if (!element) return;

    const rect = element.getBoundingClientRect();
    const elementScrollStart = rect.top - window.innerHeight + rect.height;
    const elementScrollEnd = rect.top;
    const elementScrollHalf = (elementScrollStart + elementScrollEnd) / 2;

    setScrollStart(elementScrollStart);
    setScrollHalf(elementScrollHalf);
  }, []);

  return (
    <AnimatedSvgWrapper ref={ref}>
      <svg xmlns="http://www.w3.org/2000/svg" width="192" height="156" viewBox="0 0 192 156">
        <path id="layer1" data-name="Layer 1" d="M4,0H180a4,4,0,0,1,4,4V144a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(8 8)" fill="#cecece"/>
        <motion.g id="layer2" x={translateLayer2} y={translateLayer2} transition={{ duration: 1 }}>
          <path id="Path_48" data-name="Path 48" d="M0,0H184V128a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4Z" transform="translate(4 20)" fill="#fff"/>
          <path id="Path_50" data-name="Path 50" d="M55.836,27.984A13.992,13.992,0,0,1,42,14,13.991,13.991,0,0,1,28.019.169a14.434,14.434,0,0,0-8.719,1.4L11.739,5.424a14.462,14.462,0,0,0-6.321,6.323L1.579,19.28a14.508,14.508,0,0,0-1.4,8.854L1.5,36.476a14.494,14.494,0,0,0,4.064,7.98l5.99,5.989A14.441,14.441,0,0,0,19.505,54.5l8.39,1.329a14.428,14.428,0,0,0,8.808-1.4l7.561-3.851a14.467,14.467,0,0,0,6.321-6.323l3.839-7.534a14.5,14.5,0,0,0,1.412-8.74ZM19.248,40.254a3.5,3.5,0,1,1,3.5-3.5A3.5,3.5,0,0,1,19.248,40.254Zm3.5-17.5a3.5,3.5,0,1,1,3.5-3.5A3.5,3.5,0,0,1,22.748,22.754Zm17.5,14a3.5,3.5,0,1,1,3.5-3.5A3.5,3.5,0,0,1,40.248,36.754Z" transform="translate(28.002 31.996)" fill="#e9c46a"/>
          <path id="Path_46" data-name="Path 46" d="M4,0H68a4,4,0,0,1,4,4V36a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(20 104)" fill="#cecece"/>
          <path id="Path_44" data-name="Path 44" d="M4,0h8a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(104 104)" fill="#cecece"/>
          <path id="Path_43" data-name="Path 43" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(128 104)" fill="#cecece"/>
          <path id="Path_41" data-name="Path 41" d="M4,0h8a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(104 128)" fill="#cecece"/>
          <path id="Path_40" data-name="Path 40" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(128 128)" fill="#cecece"/>
          <path id="Path_38" data-name="Path 38" d="M4,0h8a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(104 32)" fill="#cecece"/>
          <path id="Path_37" data-name="Path 37" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(128 32)" fill="#cecece"/>
          <path id="Path_35" data-name="Path 35" d="M4,0h8a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(104 56)" fill="#cecece"/>
          <path id="Path_34" data-name="Path 34" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(128 56)" fill="#cecece"/>
          <path id="Path_32" data-name="Path 32" d="M4,0h8a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(104 80)" fill="#cecece"/>
          <path id="Path_31" data-name="Path 31" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(128 80)" fill="#cecece"/>
        </motion.g>
        <motion.g id="layer3" x={translateLayer3} y={translateLayer3} transition={{ duration: 1 }}>
          <path id="Path_47" data-name="Path 47" d="M4,0H180a4,4,0,0,1,4,4V16H0V4A4,4,0,0,1,4,0Z" fill="#f0f0f0"/>
          <path id="Path_49" data-name="Path 49" d="M55.836,27.984A13.992,13.992,0,0,1,42,14,13.991,13.991,0,0,1,28.019.169a14.434,14.434,0,0,0-8.719,1.4L11.739,5.424a14.462,14.462,0,0,0-6.321,6.323L1.579,19.28a14.508,14.508,0,0,0-1.4,8.854L1.5,36.476a14.494,14.494,0,0,0,4.064,7.98l5.99,5.989A14.441,14.441,0,0,0,19.505,54.5l8.39,1.329a14.428,14.428,0,0,0,8.808-1.4l7.561-3.851a14.467,14.467,0,0,0,6.321-6.323l3.839-7.534a14.5,14.5,0,0,0,1.412-8.74ZM19.248,40.254a3.5,3.5,0,1,1,3.5-3.5A3.5,3.5,0,0,1,19.248,40.254Zm3.5-17.5a3.5,3.5,0,1,1,3.5-3.5A3.5,3.5,0,0,1,22.748,22.754Zm17.5,14a3.5,3.5,0,1,1,3.5-3.5A3.5,3.5,0,0,1,40.248,36.754Z" transform="translate(24.002 27.996)" fill="#f1da9f"/>
          <path id="Path_45" data-name="Path 45" d="M4,0H68a4,4,0,0,1,4,4V36a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(16 100)" fill="#f0f0f0"/>
          <path id="Path_42" data-name="Path 42" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(124 100)" fill="#f0f0f0"/>
          <path id="Path_39" data-name="Path 39" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(124 124)" fill="#f0f0f0"/>
          <path id="Path_36" data-name="Path 36" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(124 28)" fill="#f0f0f0"/>
          <path id="Path_33" data-name="Path 33" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(124 52)" fill="#f0f0f0"/>
          <path id="Path_30" data-name="Path 30" d="M4,0H40a4,4,0,0,1,4,4v8a4,4,0,0,1-4,4H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0Z" transform="translate(124 76)" fill="#f0f0f0"/>
          <path id="Path_26" data-name="Path 26" d="M-1.7,0a.768.768,0,0,1-.56-.24A.786.786,0,0,1-2.5-.816v-9.76l-1.168.5a1.348,1.348,0,0,1-.512.112.807.807,0,0,1-.584-.224A.765.765,0,0,1-5-10.768a.868.868,0,0,1,.128-.464.736.736,0,0,1,.4-.3l2.5-.9a.912.912,0,0,1,.16-.048.742.742,0,0,1,.144-.016.759.759,0,0,1,.584.232.845.845,0,0,1,.216.6V-.816a.786.786,0,0,1-.24.576A.8.8,0,0,1-1.7,0Zm5.36.256A1.061,1.061,0,0,1,2.88-.072a1.061,1.061,0,0,1-.328-.776A1.079,1.079,0,0,1,2.88-1.64a1.061,1.061,0,0,1,.776-.328,1.053,1.053,0,0,1,.784.328,1.093,1.093,0,0,1,.32.792,1.074,1.074,0,0,1-.32.776A1.053,1.053,0,0,1,3.656.256Z" transform="translate(108 42)" fill="#5698b2"/>
          <path id="Path_27" data-name="Path 27" d="M-5.264,0a.778.778,0,0,1-.584-.24A.8.8,0,0,1-6.08-.816a.78.78,0,0,1,.224-.576L-1.312-6.7A5.961,5.961,0,0,0-.568-7.76,2.014,2.014,0,0,0-.3-8.7,2.842,2.842,0,0,0-.544-9.92a1.818,1.818,0,0,0-.688-.792,1.982,1.982,0,0,0-1.072-.28,1.991,1.991,0,0,0-1.1.312,2.218,2.218,0,0,0-.768.832A2.374,2.374,0,0,0-4.448-8.7a.781.781,0,0,1-.232.56.778.778,0,0,1-.584.24.786.786,0,0,1-.576-.24.768.768,0,0,1-.24-.56,3.806,3.806,0,0,1,.5-1.944A3.654,3.654,0,0,1-4.232-12,3.775,3.775,0,0,1-2.3-12.5a3.7,3.7,0,0,1,1.888.464A3.167,3.167,0,0,1,.824-10.72,4.325,4.325,0,0,1,1.264-8.7a2.733,2.733,0,0,1-.216,1.04A5.42,5.42,0,0,1,.5-6.656a9.154,9.154,0,0,1-.664.864l-3.664,4.16H.656a.791.791,0,0,1,.592.248.794.794,0,0,1,.24.568.786.786,0,0,1-.24.576A.8.8,0,0,1,.656,0ZM5.216.256A1.061,1.061,0,0,1,4.44-.072a1.061,1.061,0,0,1-.328-.776A1.079,1.079,0,0,1,4.44-1.64a1.061,1.061,0,0,1,.776-.328A1.053,1.053,0,0,1,6-1.64a1.093,1.093,0,0,1,.32.792A1.074,1.074,0,0,1,6-.072,1.053,1.053,0,0,1,5.216.256Z" transform="translate(108 66)" fill="#5698b2"/>
          <path id="Path_28" data-name="Path 28" d="M-2.216,0A4.387,4.387,0,0,1-4.344-.5,3.768,3.768,0,0,1-5.8-1.88a3.71,3.71,0,0,1-.528-1.96.845.845,0,0,1,.216-.6.685.685,0,0,1,.52-.232.678.678,0,0,1,.528.232.865.865,0,0,1,.208.6A2.28,2.28,0,0,0-4.52-2.632a2.49,2.49,0,0,0,.912.88,2.572,2.572,0,0,0,1.3.328,2.448,2.448,0,0,0,1.7-.584A2.094,2.094,0,0,0,.04-3.648,2.511,2.511,0,0,0-.248-4.856a2.288,2.288,0,0,0-.784-.856,2.021,2.021,0,0,0-1.12-.32.778.778,0,0,1-.584-.24.819.819,0,0,1-.232-.592.792.792,0,0,1,.232-.584.792.792,0,0,1,.584-.232,1.751,1.751,0,0,0,.864-.232A2.031,2.031,0,0,0-.6-8.536a1.521,1.521,0,0,0,.272-.888A1.559,1.559,0,0,0-.84-10.608a1.842,1.842,0,0,0-1.312-.48,2.553,2.553,0,0,0-1.112.24,2.089,2.089,0,0,0-.8.64,1.47,1.47,0,0,0-.3.9.926.926,0,0,1-.208.616.659.659,0,0,1-.528.248.685.685,0,0,1-.52-.232.824.824,0,0,1-.216-.584,2.979,2.979,0,0,1,.48-1.664,3.342,3.342,0,0,1,1.312-1.16,4.028,4.028,0,0,1,1.856-.424,3.545,3.545,0,0,1,1.7.408A3.155,3.155,0,0,1,.72-11a2.887,2.887,0,0,1,.44,1.576,2.15,2.15,0,0,1-.28,1.1A2.933,2.933,0,0,1,.168-7.5a4.552,4.552,0,0,1-.912.568,3.8,3.8,0,0,1,1.376.776,3,3,0,0,1,.776,1.128,3.82,3.82,0,0,1,.248,1.392,3.38,3.38,0,0,1-.528,1.864A3.743,3.743,0,0,1-.28-.472,4.031,4.031,0,0,1-2.216,0ZM5.3.256a1.061,1.061,0,0,1-.776-.328A1.061,1.061,0,0,1,4.2-.848a1.079,1.079,0,0,1,.328-.792A1.061,1.061,0,0,1,5.3-1.968a1.053,1.053,0,0,1,.784.328,1.093,1.093,0,0,1,.32.792,1.074,1.074,0,0,1-.32.776A1.053,1.053,0,0,1,5.3.256Z" transform="translate(108 90)" fill="#5698b2"/>
          <path id="Path_29" data-name="Path 29" d="M-.408,0A.717.717,0,0,1-.952-.24a.815.815,0,0,1-.224-.576V-2.832H-6.5a.747.747,0,0,1-.576-.224.846.846,0,0,1-.232-.52.773.773,0,0,1,.152-.536l6.128-8.032a1.036,1.036,0,0,1,.3-.256.744.744,0,0,1,.376-.1.685.685,0,0,1,.544.24.872.872,0,0,1,.208.592V-4.3h.96a1.014,1.014,0,0,1,.576.16.641.641,0,0,1,.24.576.675.675,0,0,1-.24.52.831.831,0,0,1-.576.216H.392V-.816A.815.815,0,0,1,.168-.24.753.753,0,0,1-.408,0ZM-5.544-3.856-5.976-4.3h4.8V-10.9l.5.64ZM5.736.256A1.061,1.061,0,0,1,4.96-.072a1.061,1.061,0,0,1-.328-.776A1.079,1.079,0,0,1,4.96-1.64a1.061,1.061,0,0,1,.776-.328,1.053,1.053,0,0,1,.784.328,1.093,1.093,0,0,1,.32.792,1.074,1.074,0,0,1-.32.776A1.053,1.053,0,0,1,5.736.256Z" transform="translate(108 114)" fill="#5698b2"/>
          <path id="Path_25" data-name="Path 25" d="M-2.344,0A4.039,4.039,0,0,1-4.416-.536,3.953,3.953,0,0,1-5.872-2a4.083,4.083,0,0,1-.536-2.08.807.807,0,0,1,.224-.584A.765.765,0,0,1-5.608-4.9a.819.819,0,0,1,.592.232.778.778,0,0,1,.24.584,2.47,2.47,0,0,0,.32,1.248,2.341,2.341,0,0,0,.872.88,2.427,2.427,0,0,0,1.24.32,2.458,2.458,0,0,0,1.256-.32,2.341,2.341,0,0,0,.872-.88A2.47,2.47,0,0,0,.1-4.08a2.458,2.458,0,0,0-.32-1.256,2.359,2.359,0,0,0-.872-.872,2.458,2.458,0,0,0-1.256-.32H-5.016a.765.765,0,0,1-.576-.232.807.807,0,0,1-.224-.584v-4.32a.835.835,0,0,1,.224-.592.753.753,0,0,1,.576-.24H.328a.773.773,0,0,1,.576.248.812.812,0,0,1,.24.584.78.78,0,0,1-.232.56.778.778,0,0,1-.584.24H-4.2v2.7h1.856a4.071,4.071,0,0,1,2.088.536A3.972,3.972,0,0,1,1.2-6.168,4.071,4.071,0,0,1,1.736-4.08,4.083,4.083,0,0,1,1.2-2,3.953,3.953,0,0,1-.256-.536,4.071,4.071,0,0,1-2.344,0ZM5.544.256a1.061,1.061,0,0,1-.776-.328A1.061,1.061,0,0,1,4.44-.848a1.079,1.079,0,0,1,.328-.792,1.061,1.061,0,0,1,.776-.328,1.053,1.053,0,0,1,.784.328,1.093,1.093,0,0,1,.32.792,1.074,1.074,0,0,1-.32.776A1.053,1.053,0,0,1,5.544.256Z" transform="translate(108 138)" fill="#5698b2"/>
        </motion.g>
      </svg>
    </AnimatedSvgWrapper>
  );
}; 
